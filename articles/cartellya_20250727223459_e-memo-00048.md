---
title: "Faster R-CNN"
emoji: "✅"
type: "idea" # tech: 技術記事 / idea: アイデア
topics: ["学習記録","ニューラルネットワーク"]
published: true
---

## はじめに
:::message alert
記事内容は筆者の勉強まとめ内容です。内容の正確さや漏れについては保証できません。
ご覧いただく際は、ご自身で判断のうえ参考にしてください。
:::


## 概要
- シラバス：E資格2024#2
- Faster R-CNNモデルを勉強する

## キーワード
Region Proposal Network, アンカー, アンカーボックス, Faster R-CNN


## 学習内容
### Region Proposal Network (RPN)
- 画像特徴マップから、物体がありそうな矩形領域（バウンディングボックス候補）をリアルタイムで提案するネットワーク

#### 仕組み
1. CNNで画像全体の特徴マップを作成
2. 特徴マップの各位置に対して「アンカー（anchor）」という複数サイズ・比率の候補ボックスを設定
3. 各アンカーについて：
    - 物体があるかどうかのスコア（物体か背景か）を予測
    - アンカーの位置・サイズの微調整（バウンディングボックス回帰）
4. 物体候補となるバウンディングボックス（RoI）を絞り込み、次の検出段階へ渡す


### アンカー(Anchor)とアンカーボックス(Anchor Box)
- アンカー=基準となる候補の矩形群
- アンカーボックス=そのアンカーを物体に合わせて微調整した矩形（バウンディングボックス）

#### イメージ
| 項目                   | 内容                          | 例                            |
| -------------------- | --------------------------- | ---------------------------- |
| アンカー | 特徴マップの位置ごとに設定された固定サイズ・形状の矩形 | ある1点に対して「3種類の大きさ × 3種類の縦横比」で9つのアンカーを置く<br>「位置(x,y)で幅40×高さ30の箱」など       |
| アンカーボックス | アンカーにネットワークが予測した補正を加えた矩形    | 「アンカーから10px右にずらし、高さを35に変えた箱」 |



### Faster R-CNN
- 物体候補(Region Proposals)を検出するアルゴリズムにRegion Proposal Network (RPN)というネットワークを使用することで、end-to-endで学習できるようにしたアーキテクチャ
- 従来のR-CNN系列より高速
- 物体の識別・位置特定の両方で精度が高い
- 画像内の複数の物体も同時に検出できる

#### 処理の流れ
1. CNN（特徴抽出）　→ 入力画像から特徴マップを作成
2. Region Proposal Network（RPN）→ 画像内の「物体がありそうな領域（Region Proposal）」を提案
3. RoI Pooling+分類+ボックス回帰→ 各領域を「何か？」と判定し、正確な位置に微調整

